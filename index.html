<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Theta</title>
        <link rel="stylesheet" href="/stylesheets/content.css">
        <link rel="stylesheet" href="/stylesheets/hex.css">
        <script type="module" src="/libraries/hl.js"></script>
        <script type="module">
            const hl = window.$hl;

            const gems = [
                'Crimson Ruby	#E0115F',
                'Rose Garnet	#D94D70',
                'Cerise Spinel	#E52B50',
                'Flamingo Red Topaz	#FF4500',
                'Amber Fire Opal	#FF7F50',
                'Tangerine Carnelian	#F28500',
                'Golden Citrine	#FFD700',
                'Sunshine Yellow Diamond	#FFF44F',
                'Canary Heliodor	#FFEF00',
                'Spring Green Peridot	#99FF66',
                'Mint Chrysoprase	#00FA9A',
                'Grass Emerald	#50C878',
                'Forest Green Sapphire	#228B22',
                'Seafoam Jade	#00A36C',
                'Glacial Aquamarine	#7FFFD4',
                'Neon Paraiba Tourmaline	#40E0D0',
                'Ice Blue Diamond	#ADD8E6',
                'Robinâ€™s Egg Turquoise	#30D5C8',
                'Sky Blue Topaz	#87CEEB',
                'Azure Sapphire	#007FFF',
                'Cornflower Tanzanite	#6A5ACD',
                'Indigo Iolite	#4B0082',
                'Violet Amethyst	#8A2BE2',
                'Grape Purple Spinel	#9370DB',
                'Peach Morganite	#F4A460',
                'Blush Pink Diamond	#FFB6C1',
                'Bubblegum Rose Quartz	#FFC0CB',
                'Honey Amber	#FFBF00',
                'Salmon Coral	#FF8C69',
                'Mystic Alexandrite	#7F00FF',
            ];

            const [gem, gemColor] = hl.randomElement(gems).split('\t');

            const rarity = Math.min(35, 1 + Math.floor(-Math.log2(1 - hl.random())));

            const gemMask = new Array(144);
            const gemDensity = rarity / 35;
            for (let i = 0; i < 35; ++i) {
                gemMask[i] = i < rarity;
            }
            for (let i = 34; i > 0; --i) {
                const j = hl.randomInt(i + 1);
                const t = gemMask[i];
                gemMask[i] = gemMask[j];
                gemMask[j] = t;
            }
            for (let i = 43, j = 34; i >= 0; --i) {
                if (i < 4 || (i + 5) % 8 === 0) {
                    gemMask[i] = false;
                } else {
                    gemMask[i] = gemMask[j];
                    --j;
                }
            }
            for (let i = 48; i < gemMask.length; ++i) {
                gemMask[i] = hl.random() < gemDensity;
            }

            document.getElementById('gem').textContent = JSON.stringify({
                color: gemColor,
                mask: gemMask,
            });

            hl.token.setName(`Theta #${hl.token.id}`);
            hl.token.setTraits({
                Gem: gem,
                Rarity: rarity,
            });
        </script>
        <script type="module" src="/scripts/index.ts"></script>
    </head>
    <body>
        <audio id="loop">
            <source src="./assets/loop.aac" type="audio/aac"/>
            <source src="./assets/loop.ogg" type="audio/ogg"/>
        </audio>
        <div class="frame">
            <div class="scene">
                <div id="background"></div>
                <div id="foreground"></div>
                <div class="figure">
                    <div class="body">
                        <div class="tail"><div id="tail">
                            <div class="hex size-2 red">
                            </div>
                        </div></div>
                        <div class="wings">
                            <div class="wing-L"><div id="wing-L">
                                <div class="wing-section-0">
                                    <div class="hex size-4 red">
                                    </div>
                                    <div class="spike-0-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="spike-0-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-0-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="hex size-2 red">
                                </div>
                                <div class="wing-section-1">
                                    <div class="hex size-3 red">
                                    </div>
                                    <div class="spike-1-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="spike-1-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-1-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="wing-section-2">
                                    <div class="hex size-3 red">
                                    </div>
                                    <div class="spike-2-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-3">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-4">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                            </div></div>
                            <div class="wing-R"><div id="wing-R">
                                <div class="wing-section-0">
                                    <div class="hex size-4 red">
                                    </div>
                                    <div class="spike-0-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="spike-0-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-0-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="hex size-2 red">
                                </div>
                                <div class="wing-section-1">
                                    <div class="hex size-3 red">
                                    </div>
                                    <div class="spike-1-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="spike-1-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-1-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="wing-section-2">
                                    <div class="hex size-3 red">
                                    </div>
                                    <div class="spike-2-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-3">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                    <div class="spike-2-4">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                            </div></div>
                        </div>
                        <div class="torso">
                            <div class="hex size-4 red">
                            </div>
                            <div class="neck">
                                <div class="hex size-3 red">
                                </div>
                            </div>
                        </div>
                        <div class="head"><div id="head">
                            <div class="ears">
                                <div class="ear-L">
                                    <div class="hex size-3 red">
                                    </div>
                                </div>
                                <div class="ear-R">
                                    <div class="hex size-3 red">
                                    </div>
                                </div>
                            </div>
                            <div class="face">
                                <div class="hex size-5 red">
                                </div>
                            </div>
                            <div class="horns">
                                <div class="horn-3-L">
                                    <div class="hex size-3 red">
                                    </div>
                                </div>
                                <div class="horn-3-R">
                                    <div class="hex size-3 red">
                                    </div>
                                </div>
                                <div class="horn-3-C">
                                    <div class="hex size-3 red">
                                    </div>
                                </div>
                                <div class="horn-2-L">
                                    <div class="hex size-2 red">
                                    </div>
                                </div>
                                <div class="horn-2-R">
                                    <div class="hex size-2 red">
                                    </div>
                                </div>
                                <div class="horn-2-C">
                                    <div class="hex size-2 red">
                                    </div>
                                </div>
                                <div class="horn-1-L">
                                    <div class="hex size-1 red">
                                    </div>
                                </div>
                                <div class="horn-1-R">
                                    <div class="hex size-1 red">
                                    </div>
                                </div>
                            </div>
                            <div class="orbits">
                                <div class="orbit-L">
                                    <div class="hex size-3 red">
                                    </div>
                                    <div class="eye-L"><div id="eye-L">
                                        <div class="hex size-2 reptile">
                                        </div>
                                        <div class="hex size-0 black">
                                        </div>
                                    </div></div>
                                </div>
                                <div class="orbit-R">
                                    <div class="hex size-3 red">
                                    </div>
                                    <div class="eye-R"><div id="eye-R">
                                        <div class="hex size-2 reptile">
                                        </div>
                                        <div class="hex size-0 black">
                                        </div>
                                    </div></div>
                                </div>
                            </div>
                            <div class="nose">
                                <div class="nostril-L">
                                    <div class="hex size-2 red">
                                    </div>
                                    <div class="nostril-L-inside">
                                        <div class="hex size-1 black">
                                        </div>
                                    </div>
                                </div>
                                <div class="nostril-R">
                                    <div class="hex size-2 red">
                                    </div>
                                    <div class="nostril-R-inside">
                                        <div class="hex size-1 black">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mouth"><div id="mouth">
                                <div class="hex size-3 black">
                                </div>
                            </div></div>
                            <div class="bumps">
                                <div class="bumps-TL">
                                    <div class="bumps-TL-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="bumps-TL-1">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="bumps-TL-2">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="bumps-TR">
                                    <div class="bumps-TR-0">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="bumps-TR-1">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                    <div class="bumps-TR-2">
                                        <div class="hex size-1 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="bumps-BL">
                                    <div class="bumps-BL-1">
                                        <div class="hex size-2 red">
                                        </div>
                                    </div>
                                    <div class="bumps-BL-2">
                                        <div class="hex size-2 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="bumps-BR">
                                    <div class="bumps-BR-1">
                                        <div class="hex size-2 red">
                                        </div>
                                    </div>
                                    <div class="bumps-BR-2">
                                        <div class="hex size-2 red">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div></div>
                        <div class="legs">
                            <div class="leg-L"><div id="leg-L">
                                <div class="hex size-3 red">
                                </div>
                                <div class="toes">
                                    <div class="toe-1">
                                        <div class="hex size-2 red">
                                        </div>
                                        <div class="toenail">
                                            <div class="hex size-1 red">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="toe-2">
                                        <div class="hex size-2 red">
                                        </div>
                                        <div class="toenail">
                                            <div class="hex size-1 red">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="toe-3">
                                        <div class="hex size-2 red">
                                        </div>
                                        <div class="toenail">
                                            <div class="hex size-1 red">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div></div>
                            <div class="leg-R"><div id="leg-R">
                                <div class="hex size-3 red">
                                </div>
                                <div class="toes">
                                    <div class="toe-1">
                                        <div class="hex size-2 red">
                                        </div>
                                        <div class="toenail">
                                            <div class="hex size-1 red">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="toe-2">
                                        <div class="hex size-2 red">
                                        </div>
                                        <div class="toenail">
                                            <div class="hex size-1 red">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="toe-3">
                                        <div class="hex size-2 red">
                                        </div>
                                        <div class="toenail">
                                            <div class="hex size-1 red">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div></div>
                        </div>
                        <div class="arms">
                            <div class="arm-L"><div id="arm-L">
                                <div class="finger-1">
                                    <div class="hex size-1 red">
                                    </div>
                                    <div class="fingernail-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="hex size-2 red">
                                </div>
                                <div class="finger-2">
                                    <div class="hex size-1 red">
                                    </div>
                                    <div class="fingernail-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="finger-3">
                                    <div class="hex size-1 red">
                                    </div>
                                    <div class="fingernail-3">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                            </div></div>
                            <div class="arm-R"><div id="arm-R">
                                <div class="finger-1">
                                    <div class="hex size-1 red">
                                    </div>
                                    <div class="fingernail-1">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="hex size-2 red">
                                </div>
                                <div class="finger-2">
                                    <div class="hex size-1 red">
                                    </div>
                                    <div class="fingernail-2">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                                <div class="finger-3">
                                    <div class="hex size-1 red">
                                    </div>
                                    <div class="fingernail-3">
                                        <div class="hex size-0 red">
                                        </div>
                                    </div>
                                </div>
                            </div></div>
                        </div>
                    </div>
                    <div class="sunglasses"><div id="sunglasses" class="pulse">
                        <div class="lens-L">
                            <div class="hex size-4 funk">
                            </div>
                        </div>
                        <div class="lens-R">
                            <div class="hex size-4 funk">
                            </div>
                        </div>
                    </div></div>
                </div>
            </div>
        </div>
        <div id="gem" hidden></div>
    </body>
</html>
